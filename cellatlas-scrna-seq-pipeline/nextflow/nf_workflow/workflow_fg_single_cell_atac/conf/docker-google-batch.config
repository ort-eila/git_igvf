/*
batch.spot = true needed?
*/
process {
  withLabel: 'seqspec_local' {
    container = 'eilalan/seqspec_env:latest'
    executor = 'local'
    cpus = 1
    scratch = true
    time = '2 min'
    errorStrategy = 'terminate'
  }
  
  withLabel: 'bustool' {
    container = 'eilalan/atomic_update:latest'
    executor = 'local'
    cpus = 8
    maxRetries=1
  }

  withLabel: 'chromap_idx' {
    container = 'eilalan/chromap_env:latest'
    executor = 'google-batch'
    cpus = 32
    maxRetries =1 
    disk='300 GB'
    batch.spot = false
  }
  
  withLabel: 'chromap_map_idx' {
    container = 'eilalan/chromap_env:latest'
    executor = 'google-batch'
    errorStrategy = 'terminate'
    cpus = 32
    disk='400 GB'
    batch.spot = false
  }

  withLabel: 'chromap_local' {
    container = 'eilalan/chromap_env:latest'
    executor = 'local'
    cpus = 2
    errorStrategy = 'terminate'
    maxRetries =1 
    disk='50 GB'
  }

  withLabel: 'download' {
    container = 'eilalan/atomic_update:latest'
    executor = 'local'
    cpus = 2
    time = '20 min'
    maxRetries=1 
  }

  docker {
    enabled = true
    privileged = true
    envWhitelist=['ENV_SYNAPSE_TOKEN']
  }
}